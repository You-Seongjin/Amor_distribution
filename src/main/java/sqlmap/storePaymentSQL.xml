<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.amor.storePaymentSQL">
	<select id="aMonthAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(add_months(sysdate, -1), 'mm') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') = to_char(add_months(sysdate, -1), 'yyyy-mm')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') = to_char(add_months(sysdate, -1), 'yyyy-mm'))
		]]>
	</select>
	
	<select id="twoMonthsAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(add_months(sysdate, -2), 'mm') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') = to_char(add_months(sysdate, -2), 'yyyy-mm')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') = to_char(add_months(sysdate, -2), 'yyyy-mm'))
		]]>
	</select>
	
	<select id="threeMonthsAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(add_months(sysdate, -3), 'mm') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') = to_char(add_months(sysdate, -3), 'yyyy-mm')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') = to_char(add_months(sysdate, -3), 'yyyy-mm'))
		]]>
	</select>
	
	<select id="fourMonthsAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(add_months(sysdate, -4), 'mm') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') = to_char(add_months(sysdate, -4), 'yyyy-mm')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') = to_char(add_months(sysdate, -4), 'yyyy-mm'))
		]]>
	</select>
	
	<select id="fiveMonthsAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(add_months(sysdate, -5), 'mm') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') = to_char(add_months(sysdate, -5), 'yyyy-mm')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') = to_char(add_months(sysdate, -5), 'yyyy-mm'))
		]]>
	</select>
	
	<select id="sixMonthsAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(add_months(sysdate, -6), 'mm') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') = to_char(add_months(sysdate, -6), 'yyyy-mm')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') = to_char(add_months(sysdate, -6), 'yyyy-mm'))
		]]>
	</select>
	
	<select id="aDayAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-1, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-1, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-1, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="twoDaysAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-2, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-2, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-2, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="threeDaysAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-3, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-3, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-3, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="fourDaysAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-4, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-4, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-4, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="fiveDaysAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-5, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-5, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-5, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="sixDaysAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-6, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-6, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-6, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="sevenDaysAgo" resultType="com.amor.storePayment.model.StorePaymentDTO">
		<![CDATA[
		select nvl(sum(a), 0) as a, to_char(sysdate-7, 'mm/dd') as b from 
		(select sum(store_payment_price) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') = to_char(sysdate-7, 'yyyy-mm-dd')
		union all
		select sum(ticketing_price) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') = to_char(sysdate-7, 'yyyy-mm-dd'))
		]]>
	</select>
	
	<select id="allAll" resultType="Integer" parameterType="Map">
		<![CDATA[
		select nvl(sum(a), 0) as a from
		(select sum(store_payment_price) as a from store_payment 
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') <= #{endd}
		union all
		select sum(ticketing_price) as a from ticketing 
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') >= #{startd}
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') <= #{endd})
		]]>
	</select>
	
	<select id="allStore" resultType="Integer" parameterType="Map">
		<![CDATA[
		select nvl(sum(store_payment_price), 0) as a from store_payment 
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') <= #{endd}
		]]>
	</select>
	
	<select id="dayAll" resultType="com.amor.storePayment.model.StorePaymentDTO" parameterType="Map">
		<![CDATA[
		select * from
		(select nvl(store_payment_price, 0) as a, to_char(store_payment_paymentdate, 'yyyy-mm-dd') as b from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') <= #{endd}
		union all
		select nvl(ticketing_price, 0) as a, to_char(ticketing_reservetime, 'yyyy-mm-dd') as b from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') >= #{startd}
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') <= #{endd})
		order by b desc
		]]>
	</select>
	
	<select id="dayAllTotal" resultType="Integer" parameterType="Map">
		<![CDATA[
		select nvl(sum(aa), 0) as a from
		(select nvl(store_payment_price, 0) as aa from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') <= #{endd}
		union all
		select nvl(ticketing_price, 0) as aa from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') >= #{startd}
		and to_char(ticketing_reservetime, 'yyyy-mm-dd') <= #{endd})
		]]>
	</select>
	
	<select id="dayStore" resultType="com.amor.storePayment.model.StorePaymentDTO" parameterType="Map">
		<![CDATA[
		select nvl(store_payment_price, 0) as a, to_char(store_payment_paymentdate, 'yyyy-mm-dd') as b
		from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') <= #{endd}
		order by store_payment_paymentdate desc
		]]>
	</select>
	
	<select id="dayStoreTotal" resultType="Integer" parameterType="Map">
		<![CDATA[
		select nvl(sum(store_payment_price), 0) as a
		from store_payment
		where store_payment_status <> 'n' 
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm-dd') <= #{endd}
		]]>
	</select>
	
	<select id="monthAll" resultType="com.amor.storePayment.model.StorePaymentDTO" parameterType="Map">
		<![CDATA[
		select nvl(sum(aa), 0) as a, to_char(bb, 'yyyy-mm') as b from
		(select nvl(sum(store_payment_price), 0) as aa, to_date(to_char(store_payment_paymentdate, 'yyyy-mm'), 'yyyy-mm') as bb from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm') <= #{endd}
		group by to_char(store_payment_paymentdate, 'yyyy-mm')
		union all
		select nvl(sum(ticketing_price), 0) as aa, to_date(to_char(ticketing_reservetime, 'yyyy-mm'), 'yyyy-mm') as bb from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') >= #{startd}
		and to_char(ticketing_reservetime, 'yyyy-mm') <= #{endd}
		group by to_char(ticketing_reservetime, 'yyyy-mm'))
		group by to_char(bb, 'yyyy-mm')
		order by to_char(bb, 'yyyy-mm') desc
		]]>
	</select>
	
	<select id="monthAllTotal" resultType="Integer" parameterType="Map">
		<![CDATA[
		select nvl(sum(a), 0) as a from
		(select nvl(sum(store_payment_price), 0) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm') <= #{endd}
		group by to_char(store_payment_paymentdate, 'yyyy-mm')
		union all
		select nvl(sum(ticketing_price), 0) as a from ticketing
		where ticketing_state <> 'n'
		and to_char(ticketing_reservetime, 'yyyy-mm') >= #{startd}
		and to_char(ticketing_reservetime, 'yyyy-mm') <= #{endd})
		]]>
	</select>
	
	<select id="monthStore" resultType="com.amor.storePayment.model.StorePaymentDTO" parameterType="Map">
		<![CDATA[
		select nvl(sum(store_payment_price), 0) as a, to_char(store_payment_paymentdate, 'yyyy-mm') as b from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm') <= #{endd}
		group by to_char(store_payment_paymentdate, 'yyyy-mm')
		order by b desc
		]]>
	</select>
	
	<select id="monthStoreTotal" resultType="Integer" parameterType="Map">
		<![CDATA[
		select nvl(sum(store_payment_price), 0) as a from store_payment
		where store_payment_status <> 'n'
		and to_char(store_payment_paymentdate, 'yyyy-mm') >= #{startd}
		and to_char(store_payment_paymentdate, 'yyyy-mm') <= #{endd}
		]]>
	</select>
</mapper>