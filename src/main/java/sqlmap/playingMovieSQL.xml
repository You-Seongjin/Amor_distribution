<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.amor.playingMovieSQL">
	<select id="playingMovieList" parameterType="Map" resultType="com.amor.playingMovie.model.PlayingMovieDTO">
			select c.playing_movie_date, c.playing_movie_start, e.movie_name, d.theater_name 
			from (select * from (select rownum as rnum,a.* from 
			(select * from playing_movie order by playing_movie_idx desc)a)b 
			where rnum<![CDATA[>=]]>#{start} and rnum<![CDATA[<=]]>#{end}) c, theater d, movie e 
			where c.theater_idx=d.theater_idx and c.movie_idx=e.movie_idx
	</select>
	<select id="totalCntPlaying" resultType="Integer">
		select count(*) from playing_movie c, theater d, movie e 
		where c.theater_idx=d.theater_idx and c.movie_idx=e.movie_idx
	</select>
	<select id="playingMovieAddMovie" resultType="Map">
		select movie_name, movie_idx from movie
	</select>
	<select id="playingMovieAddScreen" resultType="Map">
		select theater_name, theater_idx from theater
	</select>
	<insert id="playingMovieAdd" parameterType="com.amor.playingMovie.model.PlayingMovieDTO">
		insert into
		playing_movie
		values (playing_movie_idx.nextval, 
		#{movie_idx}, 
		#{theater_idx}, 
		#{playing_movie_date},
		#{playing_movie_start},
		#{playing_movie_end},
		'0',
		'[]')
	</insert>
</mapper>